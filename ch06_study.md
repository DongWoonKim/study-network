# ch_06 라우팅

### 외부 네트워크로 데이터를 보낸다

> 이더넷과 무선 LAN으로 같은 네트워크 안에서 데이터를 전송할 수 있다. 하지만 다른 네트워크에 데이터를 보내려면 네트워크를 서로 연결하는 라우터로 전송해야 한다.
>
> 라우터는 데이터의 목적지가 어느 네트워크에 접속해 있는지 판단해서 연결된 네트워크의 라우터로 전송한다.(<strong>라우팅</strong>) 라우팅을 계속 반복하면, 가령 멀리 떨어진 네트워크라도 데이터를 목적지까지 보낼 수 있다.



##### 운반하는 데이터는 IP패킷

> 라우터가 전송할 대상이 되는 데이터는 IP패킷이다. IP패킷은 TCP/IP계층에서는 인터넷층에 속한다. 따라서, 라우팅 동작은 인터넷층에서 하게된다.
>
> 라우터가 IP패킷을 전송할 때는 IP 헤더 안에 있는 목적지 IP주소를 확인한다. IP헤더의 <strong>TTL</strong>과 <strong>헤더 체크섬</strong>만 변경되며, 나머지 부분은 변경되지 않은 채로 전송된다.
>
> 하지만 이더넷 헤더 등 네트워크 인터페이스층 프로토콜의 헤더는 라우터가 전송할 때 완전히 새로운 헤더로 교체된다.



### 라우터에서 네트워크 연결에 필요한 주소 설정

##### IP주소를 설정해서 네트워크를 연결한다

> 라우터로 복수의 네트워크를 연결할 때도 IP주소를 설정한다. 라우터로 네트워크를 서로 연결하기 위해서는 라우터 인터페이스의 물리적 배선에 더해 IP 주소를 설정할 필요가 있다. 
>
> 라우터에는 복수의 인터페이스가 준비되어 있으므로, 물리적인 배선과 IP주소 설정을 각각 할 필요가 있다.



### 라우팅 테이블 : 라우터가 인식하는 네트워크 정보

##### 라우팅 테이블이란?

> 라우팅 테이블에는 어떤 네트워크로 IP패킷을 전송하기 위한 경로가 등록되어 있다. 경로란 구체적으로 다음에 전송해야 하는 라우터이다. 라우팅 테이블에 등록된 네트워크 정보를 <strong>루트 정보</strong>나 <strong>경로 정보</strong>라고 부른다.

##### 이웃 라우터까지 알고 있으면 된다

> 라우터는 라우팅 테이블로 이웃 라우터의 네트워크 구성을 인식한다. 단, 네트워크 전체의 자세한 구성이 아니라, 자신을 중심으로 이웃 라우터 저 너머에 어떤 네트워크가 있는가 하는 수준이다.
>
> 라우팅 테이블 상에서 인식할 수 없는 네트워크로 가는 IP패킷은 모두 폐기된다.



### 직접 접속 : 라우팅 테이블의 가장 기본적인 정보

##### 라우팅 테이블을 만드는 방법

> - 직접 접속
> - 스태틱 라우팅
> - 라우팅 프로토콜

##### 가장 기본은 직접 접속

> <strong>직접 접속</strong>의 경로 정보는 가장 기본적인 경로 정보이다. 라우터에는 네트워크를 연결하는 역할이 있다. 직접 접속의 경로 정보는 이름 그대로 라우터가 직접 연결된 네트워크의 경로 정보이다. 라우터는 직접 접속된 네트워크밖에 모른다.



### 스택틱 라우팅, 라우팅 프로토콜 : 직접 접속되지 않은 경로 정보를 등록하는 방법

##### 원격 네트워크의 경로 정보 등록

> 직접 접속 경로 정보에 더해, 그 라우터에 직접 접속되지 않은 원격 네트워크의 경로 정보를 등록해야 한다.

##### 커맨드를 입력한다

> <strong>스태틱 라우팅</strong>은 라우터에 커맨드를 입력하는 등 경로 정보를 수동으로 라우팅 테이블에 등록하는 방법이다.
>
> 커맨드는 제조사마다 다르지만, 네트워크 주소/서브넷 마스크와 넥스트 홉 주소를 커맨드로 입력하여 라우팅 테이블에 등록한다.
>
> <img src="https://ifh.cc/g/DE7RlN.jpg" alt="l3-switch" style="zoom:30%;" />



##### 라우터끼리 정보를 교환시킨다

> 라우터에서 라우팅 프로토콜을 활성화하면, 라우터끼리 정보를 교환해 라우팅 테이블에 필요한 경로 정보를 등록해준다.
>
> |               이름                |                     개요                     |
> | :-------------------------------: | :------------------------------------------: |
> | RIP(Routing Information Protocol) |      주로 소규모 네트워크에서 이용한다.      |
> |  OSPF(Open Shortest Path First)   | 중규모 ~ 대규모 네트워크에도 대응할 수 있다. |
> |   BGP(Border Gateway Protocol)    |        주로 인터넷 백본에서 이용한다.        |
>
>  <img src="https://ifh.cc/g/udhp5B.jpg" alt="l3-switch" style="zoom:30%;" />



### 경로 요약 : 방대한 경로 정보를 모아서 등록하는 방법

##### 경로를 요약해서 등록

> 라우터의 라우팅 테이블에는 전송 가능성이 있는 모든 네트워크의 경로 정보가 필요하다. 하지만 모든 네트워크의 경로 정보를 라우팅 테이블에 등록하기는 어렵다. 라우팅 동작은 이웃 라우터(넥스트 홉)까지만 보내면 되니깐 방대한 수의 경로 정보를 저장하는 것은 의미가 없다. 
>
> 그래서 <strong>경로 요약</strong>이 고안됐다. 넥스트 홉이 공통인 원격 네트워크의 경로 정보를 하나로 모서 등록할 수 있다.









